---
defines:
- &common-card-properties
  context-capitalization: lowercase
  text-halign: start
- &suggestions-properties
  show-trigger: false
  title-capitalization: lowercase
  valign: end

# Various one-liners
- &main-card
  type: Card.Post
  properties: *common-card-properties
- &header-card Card.Title
- &no-sets 'Filter.Sets(invert: true)'

# Reused components
- &menu
  type: Layout.TopMenu
  slots: &menu-slots
    top-menu:
      type: Layout.ResponsiveMargins
      slots:
        content:
          type: Navigation.TopMenu
          slots:
            banner: 'Banner.App(show-subtitle: false)'
            menu:
              shortdef: ContentGroup.ContentGroup
              slots:
                arrangement:
                  shortdef: 'Arrangement.SideBySide(halign: center)'
                  slots:
                    card:
                      type: Card.Title
                      properties:
                        title-capitalization: lowercase
                        halign: center
                        decorate-on-highlight: true
                selection:
                  type: Selection.AllSets
                  slots:
                    filter: Filter.Featured

- &suggestions-arrangement
  shortdef: 'Arrangement.SquareGuys(max-rows: 1)'
  slots:
    card:
      type: Card.Thumb
      properties: *common-card-properties

- &set-preview
  shortdef: 'Card.SetPreview(trigger-capitalization: lowercase)'
  slots:
    arrangement:
      shortdef: 'Arrangement.Thirties(max-rows: 1)'
      slots:
        card: *main-card
        filter: *no-sets
        order: 'Order.PublishedDate(ascending: false)'
    header-card: *header-card

# Pages
- &home-page
  <<: *menu
  slots:
    <<: *menu-slots
    content:
      type: Layout.Scrolling
      slots:
        content:
          shortdef: 'Layout.DynamicBackground(page-mode: home)'
          slots:
            content:
              type: Layout.ResponsiveMargins
              slots:
                content:
                  shortdef: 'Layout.Box(orientation: vertical)'
                  slots:
                    contents:
                    - shortdef: 'ContentGroup.ContentGroup(halign: fill)'
                      styles:
                        - highlights
                      slots:
                        arrangement:
                          type: Arrangement.Piano
                          slots:
                            card: *main-card
                        selection:
                          type: Selection.AllHighlights
                          slots:
                            filter: *no-sets
                            order: 'Order.PublishedDate(ascending: false)'
                    - shortdef: 'ContentGroup.ContentGroup(halign: fill)'
                      styles:
                        - highlights
                      slots:
                        arrangement:
                          type: Arrangement.List
                          properties:
                            orientation: vertical
                            max-rows: 2
                          slots:
                            card:
                              type: Card.ContentGroup
                              slots:
                                title:
                                  type: ContentGroup.DynamicTitle
                                  properties:
                                    halign: start
                                trigger:
                                  shortdef: 'Layout.Box(orientation: horizontal, halign: end, valign: end)'
                                  slots:
                                    contents:
                                    - shortdef: 'ContentGroup.DynamicTitle(format-string: "see more from %s")'
                                    - type: Decoration.ThemeableImage
                                      properties:
                                        valign: end
                                        halign: end
                                arrangement:
                                  shortdef: 'Arrangement.Thirties(max-rows: 1)'
                                  slots:
                                    card: *main-card
                                selection:
                                  type: Selection.ArticlesForSet
                                  slots:
                                    order: 'Order.PublishedDate(ascending: false)'
                        selection:
                          type: Selection.AllSets
                          slots:
                            filter: Filter.Featured

- &section-page
  <<: *menu
  slots:
    <<: *menu-slots
    content:
      type: Layout.InfiniteScrolling
      id: theme-scroll
      slots:
        content:
          shortdef: 'Layout.DynamicBackground(page-mode: section)'
          slots:
            content:
              type: Layout.Box
              properties:
                orientation: vertical
              slots:
                contents:
                - shortdef: 'Banner.Set(halign: center)'
                  slots:
                    card: 'Card.Title(title-capitalization: lowercase)'
                - Decoration.Separator
                - shortdef: 'Layout.Box(orientation: vertical)'
                  slots:
                    contents:
                    - type: Layout.ResponsiveMargins
                      slots:
                        content:
                          shortdef: 'ContentGroup.HierarchicalSet(halign: center)'
                          slots:
                            arrangement:
                              type: Arrangement.List
                              properties:
                                row-spacing: 20
                                orientation: vertical
                              slots:
                                card: Card.List
                                order: 'Order.PublishedDate(ascending: false)'
                            set-card: *set-preview
                          references:
                            scroll-server: theme-scroll
                    - type: Layout.ResponsiveMargins
                      styles:
                        - supplementary-articles
                      slots:
                        content:
                          type: ContentGroup.SupplementaryArticles
                          properties:
                            <<: *suggestions-properties
                            same-set: false
                          slots:
                            arrangement: *suggestions-arrangement

- &search-page
  <<: *menu
  slots:
    <<: *menu-slots
    content:
      shortdef: 'Layout.DynamicBackground(page-mode: search)'
      slots:
        content:
          shortdef: 'Layout.Box(orientation: vertical)'
          slots:
            contents:
            - shortdef: 'Banner.Search(halign: center, xalign: 0.5, justify: center)'
            - type: ContentGroup.Search
              properties:
                message-halign: start
                message-justify: left
              slots:
                arrangement:
                  type: Arrangement.ScrollingList
                  slots:
                    card: Card.List
                article-suggestions:
                  type: Layout.ResponsiveMargins
                  slots:
                    content:
                      type: ContentGroup.ContentGroup
                      styles:
                        - search-page-suggestions
                      properties:
                        valign: end
                      slots:
                        title:
                          type: ContentGroup.StaticText
                          properties:
                            label: 'you might be interested in...'
                            halign: start
                        arrangement: *suggestions-arrangement
                        selection: Selection.SuggestedArticles

- &article-page
  <<: *menu
  slots:
    <<: *menu-slots
    content:
      type: Layout.ArticleStack
      properties:
        do-sliding-animation: false
        allow-navigation: next
      slots:
        card: 'Card.KnowledgeDocument(show-titles: false, show-toc: false)'
        nav-card: 'Card.List(show-synopsis: false)'

root:
  shortdef: 'Controller.Buffet(theme: news)'
  slots:
    window:
      type: Window.App
      slots:
        search: Navigation.SearchBox
        lightbox:
          type: ContentGroup.MediaLightbox
          slots:
            card: Card.Media
        pager:
          type: Pager.Simple
          slots:
            brand-page: 'Banner.App(show-subtitle: true)'
            home-page: *home-page
            section-page: *section-page
            search-page: *search-page
            article-page: *article-page
