---
defines:
- &card
  Card.LegacyPolaroid

- &main-arrangement-slot
  arrangement:
    type: Arrangement.Grid
    properties:
      halign: center
      valign: start
      expand: true
      max-children-per-line: 7
      min-children-per-line: 3
    slots:
      card: *card

- &home-page
  type: Layout.HamburgerBasement
  properties:
    show-upper-button:
      binding:
        source-id: sets-group
        property: has-more-content
  slots:
    top: 'Banner.App(halign: center)'
    middle: 'Navigation.SearchBox(halign: center, focus-on-map: true)'
    bottom:
      type: ContentGroup.ContentGroup
      id: sets-group
      properties:
        expand: true
        halign: center
        valign: center
      slots:
        arrangement:
          shortdef: 'Arrangement.Overflow(orientation: horizontal)'
          slots:
            card: *card
        selection:
          type: Selection.AllSets
    basement:
      type: Layout.InfiniteScrolling
      references:
        lazy-load: basement-sets
      slots:
        content:
          shortdef: 'ContentGroup.ContentGroup(expand: true)'
          slots:
            <<: *main-arrangement-slot
            selection:
              type: Selection.AllSets
              id: basement-sets

- &set-page
  type: Layout.InfiniteScrolling
  references:
    lazy-load: set-articles
  slots:
    content:
      shortdef: Layout.ResponsiveMargins
      slots:
        content:
          shortdef: 'Layout.Box(orientation: vertical)'
          slots:
            contents:
            - shortdef: 'Banner.Set(halign: center)'
              slots:
                card: Card.Title
            # - type: Layout.InfiniteScrolling
            # - shortdef: 'Layout.Box(orientation: vertical)'
            #   slots:
            #     contents:
            - shortdef: 'ContentGroup.ContentGroup(halign: fill)'
              # references:
              #   lazy-load: set-articles
              slots:
                arrangement:
                  type: Arrangement.List
                  properties:
                    homogenous: false
                  slots:
                    card:
                      type: Card.ContentGroup
                      # styles:
                      #   - ContentGroupHighlightsSet
                      slots:
                        # title:
                        #   type: ContentGroup.DynamicTitle
                        #   properties:
                        #     halign: start
                        # trigger: *see-more-trigger
                        arrangement:
                          shortdef: Arrangement.Constrained
                          slots:
                            card: 
                              type: Card.DefaultFamily
                              properties:
                                excluded_types:
                                  - 0
                                  - 1
                        selection:
                          # type: Selection.ArticlesForSet
                          type: Selection.ArticlesForSetCrossSection
                          id: set-articles
                          # slots:
                            # order: 'Order.PublishedDate(ascending: false)'
                selection:
                  type: Selection.AllSets

        # content:
        #   type: ContentGroup.ContentGroup
        #   slots:
        #     <<: *main-arrangement-slot
        #     selection:
        #       type: Selection.ContentForSet
        #       id: set-articles


# shortdef: 'Layout.Box(orientation: vertical)'
# styles:
#   - ContentGroupContainer
# slots:
#   contents:
#   - shortdef: 'ContentGroup.ContentGroup(halign: fill)'
#     styles:
#       - ContentGroupHighlightsAll
#     slots:
#       arrangement:
#         type: Arrangement.Piano
#         slots:
#           card: *main-card
#       selection:
#         type: Selection.AllHighlights
#         id: highlighted
#         slots:
#           filter: *no-sets
#           order: 'Order.PublishedDate(ascending: false)'
#   - shortdef: 'ContentGroup.ContentGroup(halign: fill)'
#     slots:
#       arrangement:
#         type: Arrangement.List
#         properties:
#           max-rows: 4
#           homogeneous: false
#         slots:
#           card:
#             type: Card.ContentGroup
#             styles:
#               - ContentGroupHighlightsSet
#             slots:
#               title:
#                 type: ContentGroup.DynamicTitle
#                 properties:
#                   halign: start
#               trigger: *see-more-trigger
#               arrangement:
#                 shortdef: 'Arrangement.Thirties(max-rows: 1)'
#                 slots:
#                   card: *main-card
#               selection:
#                 type: Selection.ArticlesForSet
#                 slots:
#                   order: 'Order.PublishedDate(ascending: false)'
#       selection:
#         type: Selection.AllSets
#         slots:
#           filter: Filter.Featured



- &search-page
  shortdef: 'Layout.Box(orientation: vertical)'
  slots:
    contents:
    - 'Banner.Search(halign: center)'
    - type: Layout.InfiniteScrolling
      references:
        lazy-load: search-results
      slots:
        content:
          type: ContentGroup.ContentGroup
          slots:
            <<: *main-arrangement-slot
            selection:
              type: Selection.Search
              id: search-results
            no-results: 'ContentGroup.NoResultsMessage(valign: center, halign: center, justify: center)'

- &article-page
  type: Layout.ArticleStack
  slots:
    card: 'Card.KnowledgeDocument(show-toc: true)'
    video: 'Card.Video'

root:
  shortdef: 'Controller.Mesh(theme: preset_a)'
  slots:
    window:
      type: Window.Simple
      slots:
        search: Navigation.SearchBox
        content:
          type: ContentGroup.MediaLightbox
          slots:
            card: Card.Media
            content:
              type: Layout.Navigation
              slots:
                content:
                  type: Pager.ParallaxBackground
                  slots:
                    home-page: *home-page
                    set-page: *set-page
                    search-page: *search-page
                    article-page: *article-page
